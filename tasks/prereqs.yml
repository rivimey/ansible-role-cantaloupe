---
- name: install dependencies with yum
  yum:
    name: "{{ packages }}"
  vars:
    packages:
    - unzip
    - wget
    - java-1.8.0-openjdk

- name: Install selinux-python dependency
  block:
    - name: Install for CentOS
      yum:
        name: libselinux-python
        state: present
  rescue:
    - ansible.builtin.debug:
         msg: "Try different package for RHEL"
    - name: Install for RHEL
      yum:
        name: libselinux-python3
        state: present

- name: Add repository
  yum_repository:
    name: epel
    description: EPEL YUM repo
    baseurl: https://dl.fedoraproject.org/pub/epel/7/x86_64

- name: create cantaloupe user
  user:
    name: "{{ cantaloupe_user }}"
    shell: /bin/bash
    state: present
  ignore_errors: True
